---
title: "ggplot2 themes"
output:
  rmarkdown::html_vignette:
    css: uikit.css
    toc: yes
vignette: >
  %\VignetteIndexEntry{aa-ggplot2-themes} 
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = FALSE,
  comment = "#>",
  fig.width = 7,
  fig.height = 7,
  fig.align = "center"
)
# Copy css from inst
if (FALSE) {
  file.copy("inst/css/uikit.css",
            "vignettes", overwrite = TRUE)
}
```

## Packages
```{r message=FALSE, warning=FALSE}
library(drealthemes) # Functions are in this package # Uncomment if not rsconnect
library(ggplot2)
library(dplyr)
# Just for rsconnect
library(cowplot)
library(grid)
library(gridExtra)
```

## Thème ggplot

Ce thème peut être défini globalement pour un Rmd ou une application Shiny avec `theme_set(theme_dreal())`. Cependant, créer des zones de couleurs différentes pour le titre ou la _caption_ n'est pas possible de cette manière.

```{r}
# directly in a plot
ggplot(mtcars) +
  aes(hp, mpg, colour = as.character(gear)) +
  geom_point(size = 4, alpha = .8) +
  scale_color_dreal_d() +
  ggtitle("Simple graph") +
  labs(caption = "Source: DREAL") +
  theme_dreal()

# facet plot
ggplot(mtcars) +
  aes(hp, mpg, colour = as.character(gear)) +
  geom_point(size = 4, alpha = .8) +
  scale_color_dreal_d() +
  facet_wrap(vars(carb)) +
  ggtitle("Facets graph") +
  labs(caption = "Source: DREAL") +
  theme_dreal()
```

## Thème avec un format _multiplot_

C'est le format le plus proche de la proposition graphique. Cependant, il ne fonctionne pas comme un theme classique. Il nécessite d'ajouter une fonction `drealize` à chaque graphique à la place de l'écriture du titre.

```{r}
# directly in a plot
g <- ggplot(mtcars, aes(hp, mpg, colour = as.character(gear))) +
    geom_point(size = 4, alpha = .8) +
  scale_color_dreal_d()

g2 <- drealize(g, 
         title = "Plot created with drealize()",
         caption = "Source: DREAL",
         legend.position = "bottom")

# ggsave(g2, filename = "g2.png")
# facet plot
# facet plot
g3 <- ggplot(mtcars) +
  aes(hp, mpg, colour = as.character(gear)) +
  geom_point(size = 4, alpha = .8) +
  scale_color_dreal_d() +
  facet_wrap(vars(carb))

drealize(g3, 
         title = "Facet plot created with drealize()",
         caption = "Source: DREAL",
         legend.position = "bottom")

```

Les graphiques avec légende à droite peuvent nécessiter de définir des tailles de sorties des graphs dans un Rmd pour ajuster les ratios

```{r, fig.width=9, fig.height=4}
# Plot with legend on the right
# directly in a plot
g <- ggplot(mtcars, aes(hp, mpg, colour = as.character(gear))) +
    geom_point(size = 4, alpha = .8) +
  scale_color_dreal_d()

drealize(g, 
         title = "Plot created with drealize()",
         caption = "Source: DREAL",
         legend.position = "right")
```

Barplot horizontal avec du texte
```{r}
iris %>% 
  group_by(Species) %>% 
  summarise(mean_sepalLength = mean(Sepal.Length)) %>% 
ggplot(aes(x = Species, y =  mean_sepalLength )) +
  geom_col(fill = dreal_cols("warning_active")) +
  coord_flip() +
  theme_dreal() +
  theme(axis.text.y = element_text(hjust = 0))
```

Lignes
```{r}
ggplot(data=iris, aes(x=Sepal.Length, y=Sepal.Width, color=Species)) + 
  geom_point(aes(shape=Species), size=1.5) +
  scale_color_dreal_d() +
  xlab("Sepal Length") +
  ylab("Sepal Width") +
  geom_smooth(method = "auto") +
  theme_dreal()
```


Violin/Boxplot

```{r}
iris %>% 
  ggplot(aes(x = Species, y = Sepal.Length)) +
  geom_boxplot() +
  theme_dreal()+
  stat_summary(fun.y=mean, geom="point", size=2, color=dreal_cols("warning_active"), shape = 16)

iris %>% 
  ggplot(aes(x = Species, y = Sepal.Length)) +
  geom_violin(color = dreal_cols("secondary_active")) +
  theme_dreal() +
  stat_summary(fun.y=median, geom="point", size=2, color=dreal_cols("warning_active"), shape = 16) +
  stat_summary(fun.y=mean, geom="point", size=2, color=dreal_cols("secondary_active"), shape = 3)

## OU

iris %>% 
  ggplot(aes(x = Species, y = Sepal.Length)) +
  geom_violin(color = dreal_cols("secondary_active"), fill =  dreal_cols("secondary_light")) +
  theme_dreal() +
  geom_boxplot(width=0.1, color =  dreal_cols("secondary_active")) +
  stat_summary(fun.y=mean, geom="point", size=2, color=dreal_cols("warning_active"), shape = 16)

```



